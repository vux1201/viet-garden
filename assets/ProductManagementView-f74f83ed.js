import{u as N}from"./UserSearch-27d7ffe7.js";import{_ as T,q as f,m as q,S as c,g as x,r as b,o as n,c as a,a as t,b as C,e as h,t as u,F as w,l as P,k,i as p,x as I,v as _,p as B,f as U}from"./index-eee19d7a.js";const z={data(){return{page:1,size:6,show:!1,uploadImg:null,newImage:"",images:[],store:f,valCategory:[],newProduct:{category_id:"",name:"",price:"",inventory:"",summary:"",detail:"",product_images:[]},id_product:"",name_category:"",product:""}},async created(){try{this.params.page=this.page,this.params.size=this.size,await this.getProducts(this.params),await this.getCategories(this.params),console.log(this.allCategory,"pro")}catch(e){console.log(e)}},methods:{...q(f,["getProducts","getProduct","getCategories","uploadImage","postProducts","putProducts","deleteProduct"]),addProducts(){this.show=!this.show},idGroup(e){console.log("id-cre",e),this.valCategory=e},idCategory(e){console.log("id-cate",e),this.newProduct.category_id=e},changeImage(e){var s=e.target.files||e.dataTransfer.files;s.length&&(this.createImage(s),this.uploadImg=s,console.log(s,"filess"))},createImage(e){for(var s=this,r=0;r<e.length;r++){var g=new FileReader;g.onload=function(d){const i=d.target.result;s.images.push(i)},g.readAsDataURL(e[r])}},remoteImage(e){this.images.splice(e,1)},async createNewProduct(){try{let e;const s=(r,g)=>{e={...r,product_images:[{image_path:g}]}};await this.uploadImage(this.uploadImg,{...this.newProduct},s),console.log(e,"this.newProduct.image_path"),await this.postProducts(e),setTimeout(()=>{this.show=!this.show},"2500"),await this.getProducts(this.params),c.fire({position:"top-center",icon:"success",title:"Thêm thành công",showConfirmButton:!1,timer:2e3})}catch(e){console.log(e)}},idProduct(e){var s,r;this.id_product=e.id,this.name_category=(s=e.category)==null?void 0:s.name,this.newProduct.category_id=(r=e.category)==null?void 0:r.id,this.newProduct.name=e.name,this.newProduct.price=e.price,this.newProduct.inventory=e.inventory,this.newProduct.summary=e.summary,this.newProduct.detail=e.detail,this.newProduct.product_images=e.product_images,console.log(this.newProduct,"id_upPro")},async updateNewProduct(){try{console.log("object",this.newProduct);let e;const s=(r,g)=>{e={...r,product_images:[{image_path:g}]}};await this.uploadImage(this.uploadImg,{...this.newProduct},s),console.log(e,"this.newProduct.image_path"),await this.putProducts(this.id_product,e),console.log(e,"anhr"),setTimeout(()=>{this.show=!this.show},"2500"),c.fire({position:"top-center",icon:"success",title:"Đã cập nhật",showConfirmButton:!1,timer:2e3}),await this.getProducts(this.params)}catch(e){console.log(e)}},async handleDelete(e){try{c.fire({title:"Bạn có chắc muốn xóa!",text:"Bạn sẽ không thể khôi phục dữ liệu này!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Xóa"}).then(async s=>{s.isConfirmed&&(await this.deleteProduct(e),this.params.page=this.page,this.params.size=this.size,await this.getProducts(this.params),c.fire("Đã xóa!","Sản phẩm đã được xóa.","success"))})}catch(s){console.log(s)}},clickCancel(){let e;c.fire({title:"Đang quay lại!",timer:200,timerProgressBar:!0,didOpen:()=>{c.showLoading();const s=c.getHtmlContainer().querySelector("b");e=setInterval(()=>{s.textContent=c.getTimerLeft()},100)},willClose:()=>{clearInterval(e)}}).then(s=>{s.dismiss===c.DismissReason.timer&&console.log("I was closed by the timer")}),location.reload()},async updatePage(e,s){try{this.params.page=e,this.params.size=s,await this.getProducts(this.params)}catch(r){console.log(r)}},totalPrice(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"VND"}).format(e)}},computed:{...x(f,["params","totalProduct","image_path","allProducts","allCategory"]),totalPages(){let e=this.totalProduct.total/this.size;return Math.ceil(e)}},components:{userSearch:N}},l=e=>(B("data-v-829522f1"),e=e(),U(),e),D={class:"content"},L={key:0,class:"show-products"},M={class:"head"},F=l(()=>t("div",{class:"title1"},"Quản lý sản phẩm",-1)),G=l(()=>t("i",{class:"fa-light fa-circle-plus"},null,-1)),H={style:{left:"20px",color:"rgb(9, 90, 106)"}},A={class:"container"},R=l(()=>t("thead",null,[t("th",null,"Id sản phẩm"),t("th",null,"Tên sản phẩm"),t("th",null,"Hình ảnh"),t("th",null,"Giá sản phẩm"),t("th",null,"Số lượng"),t("th",null,"Action")],-1)),E=["src"],j=["onClick"],O=["onClick"],Q={class:"text-center"},X={key:1,class:"show-addProducts"},J=l(()=>t("h2",{class:"title1"},"Thông tin sản phẩm",-1)),K={class:"form-input"},W=l(()=>t("label",null,[h("Nhóm danh mục "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),Y={key:0,class:"form-categories"},Z=l(()=>t("option",{disabled:"",selected:""},"Vui lòng chọn nhóm danh mục !",-1)),$=["value"],tt={key:1,class:"form-categories"},et={class:"form-input"},st=l(()=>t("label",null,[h("Loại sản phẩm "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),ot={key:0,class:"form-categories"},it=l(()=>t("option",{disabled:"",selected:""},"Vui lòng chọn danh mục !",-1)),nt=["value"],at={key:1,class:"form-categories"},lt={class:"form-input"},rt=l(()=>t("label",null,[h("Tên sản phẩm "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),dt={class:"form-input"},ct=l(()=>t("label",null,[h("Hình ảnh "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),ut={class:"list-img"},ht=["src"],mt=["onClick"],gt=l(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),pt=[gt],_t={class:"form-input"},yt=l(()=>t("label",null,[h("Mô tả "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),wt={class:"form-input"},Pt=l(()=>t("label",null,[h("Chi tiết "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),ft={class:"form-input"},vt=l(()=>t("label",null,[h("Số lượng hàng "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),bt={class:"form-input"},Ct=l(()=>t("label",null,[h("Giá sản phẩm "),t("a",{title:"trường bắt buộc"},"(*)")],-1)),kt={class:"footer"};function It(e,s,r,g,d,i){var v;const V=b("userSearch"),S=b("v-pagination");return n(),a("div",D,[d.show==!1?(n(),a("div",L,[t("div",M,[F,C(V)]),t("button",{class:"btn-adduser",href:"#edit",onClick:s[0]||(s[0]=(...o)=>i.addProducts&&i.addProducts(...o))},[G,h(" Thêm sản phẩm ")]),t("div",H," Tổng sản phẩm: "+u(e.totalProduct.total),1),t("table",A,[R,t("tbody",null,[(n(!0),a(w,null,P(e.allProducts,(o,m)=>(n(),a("tr",{key:m},[t("td",null,"#"+u(o.id),1),t("td",null,u(o.name),1),t("td",null,[t("img",{style:{width:"200px",height:"200px"},src:o.product_images[0].image_path},null,8,E)]),t("td",null,u(i.totalPrice(o.price)),1),t("td",null,u(o.inventory),1),t("td",null,[t("a",{onClick:s[1]||(s[1]=(...y)=>i.addProducts&&i.addProducts(...y))},[t("i",{class:"fa fa-file-pen",title:"edit",onClick:y=>i.idProduct(o)},null,8,j)]),t("a",null,[t("i",{onClick:y=>i.handleDelete(o.id),class:"fa-regular fa-trash-can",title:"delete",style:{"--fa-primary-color":"crimson"}},null,8,O)])])]))),128))])]),t("div",Q,[C(S,{modelValue:d.page,"onUpdate:modelValue":[s[2]||(s[2]=o=>d.page=o),s[3]||(s[3]=o=>i.updatePage(d.page,d.size))],length:i.totalPages,rounded:"circle"},null,8,["modelValue","length"])])])):k("",!0),d.show==!0?(n(),a("div",X,[t("div",null,[J,t("div",K,[W,this.id_product?(n(),a("div",tt,[t("p",null,u((v=this.newProduct)==null?void 0:v.name_group),1)])):(n(),a("div",Y,[p(t("select",{class:"category-groups","onUpdate:modelValue":s[4]||(s[4]=o=>e.modal=o),onChange:s[5]||(s[5]=o=>i.idGroup(e.modal.categories))},[Z,(n(!0),a(w,null,P(e.allCategory.results,(o,m)=>(n(),a("option",{key:m,value:o},u(o.name),9,$))),128))],544),[[I,e.modal]])]))]),t("div",et,[st,this.id_product?(n(),a("div",at,[t("p",null,u(this.name_category),1)])):(n(),a("div",ot,[p(t("select",{class:"categories",required:"","onUpdate:modelValue":s[6]||(s[6]=o=>e.modal=o),onChange:s[7]||(s[7]=o=>i.idCategory(e.modal.id))},[it,(n(!0),a(w,null,P(d.valCategory,(o,m)=>(n(),a("option",{key:m,value:o},u(o.name),9,nt))),128))],544),[[I,e.modal]])]))]),t("div",lt,[rt,p(t("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=o=>this.newProduct.name=o),required:""},null,512),[[_,this.newProduct.name]])]),t("div",dt,[ct,t("div",ut,[(n(!0),a(w,null,P(d.images,(o,m)=>(n(),a("div",{class:"img",key:m},[t("img",{src:o||d.newProduct.product_images[0].image_path},null,8,ht),t("button",{class:"btn-del-img",onClick:y=>i.remoteImage(m)},pt,8,mt)]))),128))]),t("input",{style:{border:"none",top:"-1px"},accept:"image/*",type:"file",onChange:s[9]||(s[9]=(...o)=>i.changeImage&&i.changeImage(...o)),multiple:"",required:""},null,32)]),t("div",_t,[yt,p(t("textarea",{type:"text","onUpdate:modelValue":s[10]||(s[10]=o=>this.newProduct.summary=o),required:"required"},null,512),[[_,this.newProduct.summary]])]),t("div",wt,[Pt,p(t("textarea",{type:"text","onUpdate:modelValue":s[11]||(s[11]=o=>this.newProduct.detail=o),required:"required"},null,512),[[_,this.newProduct.detail]])]),t("div",ft,[vt,p(t("input",{type:"number","onUpdate:modelValue":s[12]||(s[12]=o=>this.newProduct.inventory=o),required:""},null,512),[[_,this.newProduct.inventory]])]),t("div",bt,[Ct,p(t("input",{type:"number","onUpdate:modelValue":s[13]||(s[13]=o=>this.newProduct.price=o),required:""},null,512),[[_,this.newProduct.price]])]),t("div",kt,[this.id_product?(n(),a("button",{key:1,class:"btn-adduser",onClick:s[15]||(s[15]=(...o)=>i.updateNewProduct&&i.updateNewProduct(...o))}," Cập nhật ")):(n(),a("button",{key:0,class:"btn-adduser",type:"submit",onClick:s[14]||(s[14]=(...o)=>i.createNewProduct&&i.createNewProduct(...o))}," Lưu ")),t("button",{class:"btn-adduser",type:"submit",onClick:s[16]||(s[16]=(...o)=>i.clickCancel&&i.clickCancel(...o))}," Hủy ")])])])):k("",!0)])}const Nt=T(z,[["render",It],["__scopeId","data-v-829522f1"]]);export{Nt as default};
